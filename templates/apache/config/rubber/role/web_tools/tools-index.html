<%
  @path = "/var/www/index.html"
  tools_host = rubber_instances.for_role('web_tools').first
%>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
		<title>Rubber Admin Tools</title>
	</head>
	<body>
		<h1>Rubber Admin Tools</h1>
		<ul>

      <% if File.exist?("/var/www/munin") %>
        <li><a href="/munin/">Munin</a></li>
      <% end %>

		  <% rubber_instances.for_role('haproxy').sort {|a,b| a.name <=> b.name }.each do |ic| %>
		      <li><a href="/haproxy_<%= ic.name %>/">HAProxy <%= ic.name %></a></li>
		  <% end %>

      <% rubber_instances.sort {|a,b| a.name <=> b.name }.each do |ic| %>
          <li><a href="/monit_<%= ic.name %>/">Monit <%= ic.name %></a></li>
      <% end %>
       
      <%
        # add the ip aliases for web tools hosts so we can map internal tools
        # to their own vhost to make proxying easier (rewriting url paths for
        # proxy is a real pain, e.g. '/graphite/' externally to '/' on the
        # graphite web app)
        Array(rubber_env.web_tools_proxies).each do |name, settings|
      %>
        <li><a href="https://<%= name %>.<%= tools_host.full_name %>:<%= rubber_env.web_tools_ssl_port %>/"><%= name.capitalize %></a></li>
      <% end %>

		</ul>
	</body>
</html>
